<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Check Registration Status</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background: linear-gradient(135deg, #ff6f61, #d500f9);
      color: #fff;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }

    .navbar {
      background-color: rgba(0, 0, 0, 0.8);
    }

    .navbar-brand {
      font-size: 1.5rem;
      color: #fff;
    }

    .navbar-nav .nav-link {
      color: #fff !important;
    }

    .navbar-nav .nav-link:hover {
      color: #ffeb3b !important;
    }

    .container {
      margin-top: 70px;
      background: rgba(0, 0, 0, 0.6);
      border-radius: 10px;
      padding: 20px;
    }

    h2, h3, h4 {
      color: #ffeb3b;
    }

    .result-table {
      background-color: #333;
      border: 1px solid #ffeb3b;
      border-radius: 0.25rem;
    }

    .result-table th {
      background-color: #ff5722;
      color: #fff;
    }

    .result-table td {
      background-color: #555;
      color: #fff;
    }

    .result-table tr:nth-child(even) td {
      background-color: #444;
    }

    .error-message {
      color: #ff5722;
      margin-top: 20px;
    }

    .success-message {
      color: #76ff03;
      margin-top: 20px;
    }

    .btn-primary {
      background: linear-gradient(135deg, #ff4081, #ff5722);
      border: none;
    }

    .btn-primary:hover {
      background: linear-gradient(135deg, #ff5722, #ff4081);
    }

    @media (max-width: 768px) {
      .result-table th,
      .result-table td {
        padding: 0.5rem;
      }

      .result-table {
        font-size: 0.9rem;
      }
    }

    @media (max-width: 576px) {
      h2 {
        font-size: 1.5rem;
      }
      .container {
        padding: 10px;
      }
    }

    /* Footer Styling */
    .footer {
      background-color: rgba(0, 0, 0, 0.8);
      color: #fff;
      padding: 20px 0;
      text-align: center;
      font-size: 0.9rem;
      border-top: 3px solid #ffeb3b;
    }

    .footer a {
      color: #ffeb3b;
      text-decoration: none;
    }

    .footer a:hover {
      text-decoration: underline;
    }

    .footer .social-icons a {
      margin: 0 10px;
      color: #ffeb3b;
    }

    .footer .social-icons a:hover {
      color: #ff4081;
    }
  </style>
</head>

<body>
  <!-- Responsive Bootstrap Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark">
    <a class="navbar-brand" href="#">Student Portal</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav"
      aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link" href="home.html">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">About</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Services</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Contact</a>
        </li>
        <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" id="userDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Profile
            </a>
            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
              <li class="dropdown-header">User: <span id="userEmail">User</span></li>
              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item" href="#" id="logout" style="color: red;"><i class="fa fa-sign-out"></i> Logout</a></li>
            </ul>
          </li>
      </ul>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="container">
    <h2 class="text-center mt-4">Check Registration Status</h2>
    <form id="status-check-form">
      <div class="form-group">
        <label for="applicationNumber">Application Number:</label>
        <input type="text" class="form-control" id="applicationNumber" placeholder="Enter your application number" required>
      </div>
      <button type="submit" class="btn btn-primary">Check Status</button>
    </form>

    <div id="result" class="mt-4">
      <!-- Registration details will be displayed here -->
    </div>
  </div>

  <!-- Professional Footer -->
  <footer class="footer">
    <div class="container">
      <p>&copy; 2024 MySite. All rights reserved. by EleGets</p>
      <p>
        <a href="#">Privacy Policy</a> | <a href="#">Terms of Service</a> | <a href="#">Contact Us</a>
      </p>
      <div class="social-icons">
        <a href="#"><i class="fab fa-facebook"></i></a>
        <a href="#"><i class="fab fa-twitter"></i></a>
        <a href="#"><i class="fab fa-linkedin"></i></a>
        <a href="#"><i class="fab fa-instagram"></i></a>
      </div>
    </div>
  </footer>

  <!-- JavaScript and jQuery for Bootstrap -->
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
  <script src="https://kit.fontawesome.com/a076d05399.js"></script> <!-- For social media icons -->
  <script>
    const API_KEY = 'AIzaSyA50bU6XgXX6VG5iQ2hjJDxx3yARwb4oB8'; // Replace with your API key
    const SHEET_ID = '1-XrBy324wT2KIDyqFve5EnUHF8MsvW7uGwQeChuByqE'; // Replace with your Google Sheet ID

    $('#status-check-form').submit(function (event) {
      event.preventDefault();
      const applicationNumber = $('#applicationNumber').val();

      // Fetch data from Google Sheets API
      $.ajax({
        url: `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/Sheet1?key=${API_KEY}`,
        type: 'GET',
        success: function (response) {
          const data = response.values;
          let registration = null;
          let members = [];

          // Find the registration row
          for (let i = 1; i < data.length; i++) {
            if (data[i][0] == applicationNumber) {
              registration = {
                applicationNumber: data[i][0],
                email: data[i][1],
                teamName: data[i][2],
                event: data[i][3],
                teamSize: data[i][4],
                members: []
              };

              // Get the team members
              for (let j = i + 1; j < i + 1 + parseInt(registration.teamSize); j++) {
                if (data[j]) {
                  members.push({
                    name: data[j][5],
                    jntu: data[j][6],
                    contact: data[j][7],
                    branch: data[j][8],
                    section: data[j][9]
                  });
                }
              }
              registration.members = members;
              break;
            }
          }

          const resultDiv = $('#result');
          resultDiv.empty();

          if (registration) {
            // Display registration details
            resultDiv.append(`
              <h3 class="success-message">Registration Details</h3>
              <table class="table result-table">
                <thead>
                  <tr>
                    <th>Field</th>
                    <th>Value</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td><strong>Email</strong></td><td>${registration.email}</td></tr>
                  <tr><td><strong>Team Name</strong></td><td>${registration.teamName}</td></tr>
                  <tr><td><strong>Event</strong></td><td>${registration.event}</td></tr>
                  <tr><td><strong>Team Size</strong></td><td>${registration.teamSize}</td></tr>
                </tbody>
              </table>
            `);

            // Display team members in a single table
            resultDiv.append(`
              <h4 class="success-message">Team Members</h4>
              <table class="table result-table">
                <thead>
                  <tr>
                    <th>SN</th>
                    <th>Name</th>
                    <th>JNTU Number</th>
                    <th>Contact</th>
                    <th>Branch</th>
                    <th>Section</th>
                  </tr>
                </thead>
                <tbody>
                ${registration.members.map((member, index) => `
                  <tr>
                    <td>${index + 1}</td>
                    <td>${member.name}</td>
                    <td>${member.jntu}</td>
                    <td>${member.contact}</td>
                    <td>${member.branch}</td>
                    <td>${member.section}</td>
                  </tr>`).join('')}
                </tbody>
              </table>
            `);
          } else {
            resultDiv.append(`<h3 class="error-message">No details found for this application number.</h3>`);
          }
        },
        error: function (error) {
          $('#result').append(`<h3 class="error-message">Error fetching data. Please try again later.</h3>`);
        }
      });
    });
  </script>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-app.js";
    import { getAuth, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-auth.js";
  
    // Firebase configuration
    const firebaseConfig = {
        apiKey: "AIzaSyBp0QsE20S-TMQRHHbYJllfEXiZ-2INXPo",
        authDomain: "project-gmrit.firebaseapp.com",
        projectId: "project-gmrit",
        storageBucket: "project-gmrit.appspot.com",
        messagingSenderId: "425997448351",
        appId: "1:425997448351:web:4601965fe529c6d59f9eaa",
        measurementId: "G-JJ6SFEGELX"
      };
  
    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
  
    // Check if user is logged in
    onAuthStateChanged(auth, (user) => {
      const userEmailElement = document.getElementById('userEmail');
      if (user) {
        userEmailElement.textContent = user.email;
      } else {
        window.location.href = 'index.html';
      }
    });
  
    // Logout function
    document.getElementById('logout').addEventListener('click', async (e) => {
      e.preventDefault();
      try {
        await signOut(auth);
        localStorage.clear();
        window.location.href = 'index.html';
      } catch (error) {
        console.error('Error signing out:', error.message);
        alert('Failed to sign out. Please try again.');
      }
    });
  </script>
</body>

</html>
